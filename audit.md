# Аудит смарт контрактов BitWork.
Статус - в работе.

Код контрактов проверен на предмет программных закладок и критических ошибок способных привести к потере денег инвесторами.
Некоторые контракты используют методы библиотеки SafeMath для безопасных вычислений.

# 1. Контракт CourseContract

Заявленный функционал контракта CourseContract - продажа обучающих курсов за криптовалюту (ETH).

Контракт наследует функционал контрактов Adminable и Ownable.

Функционал контракта Adminable реализует ограничение доступа к функциям контракта посредством модификатора onlyAdminAndOwner.
Модификатор onlyAdminAndOwner ограничивает вызов функций ролями owner либо admin. Установка роли admin осуществляется через функцию setAdmin, вызов которой ограничен ролью owner, посредством модификатора onlyOwner, реализованного в контракте Ownable.

Функционал контракта Ownable реализует ограничение доступа к функциям контракта посредством модификатора onlyOwner.
Модификатор onlyOwner ограничивает вызов функции ролью owner. Роль owner устанавливается при деплое контракта в значение адреса, с которого происходит деплой. Установка нового значения owner осуществляется посредством вызова функции transferOwnership через параметр address newOwner, значение newOwner не может быть нулевым. 

Переменные:



Основной фукционал :

При создании контракта происходит инициализация следующих переменных:

ethusd - текущая стоимость 1 eth в usd передается в качестве параметра при создании контракта;
firstCoursePrice = 250 - стоимость первого курса в usd;
secondCoursePrice = 500 - стоимость второго курса в usd;
firstCoursePriceWei = ;
secondCoursePriceWei;

Функция pricesRecalculation осуществляет пересчет переменных содержащих стоимость первого (firstCoursePriceWei) и второго (secondCoursePriceWei) курсов из usd в wei.


Контракт содердит функцию, которая выполняется автоматически при посутплении на его адрес эфиров в количестве, превышающем значение переменной minFirstCoursePriceWei, а так же при условии, что значение переменной coursePaymentsAreStopped = false. Первоначальное значение переменной coursePaymentsAreStopped устанавливается в false при вызове конструктора контракта CourseContract (т.е. при его деплое в сети).
Значение переменной coursePaymentsAreStopped может быть изменено в true только вызовом функции stopCoursePayments, доступной только для роли owner. Значение переменной coursePaymentsAreStopped может быть изменено в false только вызовом функции stopCoursePayments, доступной только для роли owner. Расшифровка: приостановить прием оплаты за курсы и возобновить его может только владелец контракта в любой момент.

Если сумма перечисленных на адрес контракта эфиров меньше либо равна значению переменной maxFirstCoursePriceWei, осуществляется вызов функции реализующей покупку курса: courseBought с параметром в виде количества переведенных средств, а так же генерируется событие покупки первого курса - FirstCourseBought.

Если сумма перечисленных на адрес контракта эфиров меньше либо равна значению переменной minSecondCoursePriceWei, разница между количеством присланных средств и значением переменной firstCoursePriceWei выплачивается отправителю, осуществляется вызов функции реализующей покупку курса: courseBought с параметром в виде цены первого курса: firstCoursePriceWei, а так же генерируется событие покупки первого курса - FirstCourseBought.

Если сумма перечисленных на адрес контракта эфиров меньше либо равна значению переменной maxSecondCoursePriceWei, осуществляется вызов функции реализующей покупку курса: courseBought с параметром в виде количества переведенных средств, а так же генерируется событие покупки первого курса - SecondCourseBought.

Если сумма перечисленных на адрес контракта эфиров больше значения переменной maxSecondCoursePriceWei, разница между количеством присланных средств и значением переменной secondCoursePriceWei выплачивается отправителю, осуществляется вызов функции реализующей покупку курса: courseBought, а так же генерируется событие FirstCourseBought.


